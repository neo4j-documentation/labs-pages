= Neo4j Vector Index and Search
include::_graphacademy_llm.adoc[]
:slug: vector-search
:author: 
:category: genai-ecosystem
:tags: vector index, vector search, embeddings, neo4j
:neo4j-versions: 5.11+
:page-pagination:
:page-product: neo4j
// NODES 2024 AD
:page-ad-overline-link: https://neo4j.registration.goldcast.io/events/03805ea9-fe3a-4cac-8c15-aa622666531a?utm_source=neodocs&utm_medium=banner&utm_campaign=std
:!page-ad-icon:
:!page-ad-overline:
:page-ad-image: https://neo4j.com/docs/assets/img/nodes-24.png
:page-ad-title: Neo4j Online Developer Conference
:page-ad-description: Join us on November 7 for live and unique tech talks over 24 hours across all timezones.
:page-ad-link: https://neo4j.registration.goldcast.io/events/03805ea9-fe3a-4cac-8c15-aa622666531a?utm_source=neodocs&utm_medium=banner&utm_campaign=std
:page-ad-underline-role: button
:page-ad-underline: Register

image::https://dist.neo4j.com/wp-content/uploads/20230821135317/Grounding-LLM-Responses-with-Implicit-and-Explicit-Search-Through-Neo4js-Knowledge-Graph-2048x1152.png[width=800]

The Neo4j Vector index implements HNSW (Hierarchical Navigatable Small World) for creating layers of k-nearest neighbors to enable efficient and robust approximate nearest neighbor search. 
The index is designed to work with embeddings, such as those generated by machine learning models, and can be used to find similar nodes in a graph based on their embeddings.

== Functionality Includes

* Create a vector index with a specified number of dimensions and similarity function (euclidean, cosine) for both nodes and relationships
* Query vector index with embedding and top-k, returning nodes and similarity score
* Procedures to compute text vector embeddings with (Azure) OpenAI, AWS Bedrock, Google Vertex AI, and other ML platforms 
* Vector similarity functions to compute cosine angle and euclidean distance between vectors

image::https://cdn.graphacademy.neo4j.com/assets/img/courses/banners/llm-vectors-unstructured.png[width=800,link="https://graphacademy.neo4j.com/courses/llm-vectors-unstructured/"]

== Usage

[source,cypher]
----
// create vector index
CREATE VECTOR INDEX `abstract-embeddings`
FOR (n: Abstract) ON (n.embedding)
OPTIONS {indexConfig: {
 `vector.dimensions`: 1536,
 `vector.similarity_function`: 'cosine'
}};


// set embedding as parameter
MATCH (a:Abstract {id: $id})
CALL db.create.setNodeVectorProperty(a, 'embedding', $embedding);


// use a genai function to compute the embedding
MATCH (a:Abstract {id: $id})
WITH a, genai.vector.encode(a.text, "OpenAI", { token: $token }) AS embedding
CALL db.create.setNodeVectorProperty(n, 'embedding', embedding);


// query vector index for similar abstracts
MATCH (title:Title)<--(:Paper)-->(abstract:Abstract)
WHERE title.text CONTAINS = 'hierarchical navigable small world graph'
CALL db.index.vector.queryNodes('abstract-embeddings', 10, abstract.embedding)
YIELD node AS similarAbstract, score

MATCH (similarAbstract)<--(:Paper)-->(similarTitle:Title)
RETURN similarTitle.text AS title, score;


// use cosine similarity for exact nearest neighbor search
// pre-filter vector search
MATCH (venue:Venue)<--(:Paper)-->(abstract:Abstract)
WHERE venue.name CONTAINS 'NETWORK'

WITH abstract, paper, 
     vector.similarity.cosine(abstract.embedding, $embedding) AS score
WHERE score > 0.9

RETURN paper.title AS title, abstract.text, score
ORDER BY score DESC LIMIT 10;
----

== Documentation

== Relevant Links
[cols="1,4"]
|===
| icon:user[] Authors | Neo4j Engineering
| icon:comments[] Community Support | https://community.neo4j.com/[Neo4j Online Community^]
| icon:github[] Repository | https://github.com/neo4j/neo4j[GitHub]
| icon:github[] Issues | https://github.com/neo4j/neo4j/issues
| icon:book[] Documentation | https://neo4j.com/docs/cypher-manual/current/indexes/semantic-indexes/vector-indexes/[Vector Index and Search^]
| icon:book[] Documentation | https://neo4j.com/docs/cypher-manual/current/genai-integrations/[GenAI Embedding Procedures^]
| icon:book[] Documentation | https://neo4j.com/docs/cypher-manual/current/functions/vector/[Vector Similarity Functions^]
|===


== Videos & Tutorials

++++
<iframe width="560" height="315" src="https://www.youtube.com/embed/bRD09ndyJNs?si=jtFV39xD6YkbjmuG" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
++++

== Highlighted Articles

* https://neo4j.com/blog/vector-search-deeper-insights/[​​Neo4j’s Vector Search: Unlocking Deeper Insights for AI-Powered Applications^]
* https://www.linkedin.com/pulse/vector-indexing-plus-knowledge-graphs-neo4j-jeff-tallman-ayxve/[Vector Indexing plus Knowledge Graphs in Neo4j^]
* https://medium.com/@therobbrennan/explore-openai-vector-embedding-with-neo4j-6ea2a40693d9[Explore OpenAI Vector Embedding with Neo4j^]
* https://medium.com/neo4j/youtube-transcripts-knowledge-graphs-for-rag-applications-2cc790543d4b[YouTube Transcripts Into Knowledge Graphs for RAG Applications]
